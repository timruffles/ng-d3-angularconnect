<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Angular and D3</title>
  
  <link rel="stylesheet" href="reveal/css/reveal.min.css">
  <link rel="stylesheet" href="reveal/lib/css/googlecode.css">

  <link rel="stylesheet" href="slides-theme/style.css">
  <link rel="stylesheet" href="slides-theme/talk-specific.css">

  <!-- demos -->
  <link rel="stylesheet" href="js/d3-contexts-explained.css">

  <!-- for live coding -->
  <link rel="stylesheet" href="js/little-console.css" id="theme">

  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24335480-1']);
  _gaq.push(['_trackPageview']);

  var asyncScript = function(src) {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = src;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  };

  asyncScript(('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js');
  </script>

  <script src="js/revealHooks.js">
    
  </script>

</head>

<body>

  <div class="reveal">
    <div class="slides">
<section data-state='title' class=""><h2 id="d3-in-angular-angular-in-d3">D3 in Angular, Angular in D3</h2>
<p>@timruffles</p>
<p>timr.co</p>
</section>

<section data-state='title' class=""><h2 id="my-year">My year</h2>
</section>

<section  class=""><h2 id="a-suprise">A suprise</h2>
</section>

<section  class=""><h2 id="you-built-what-">You built what?!</h2>
<p><img src="img/transitions.gif" alt="transitions"></p>
</section>

<section  class=""><h2 id="i-said-yes">I said yes</h2>
</section>

<section  class=""><h2 id="i-wanted-to-build-cool-things">I wanted to build cool things</h2>
<p><img src="img/transitions-b.gif" alt="transitions"></p>
</section>

<section data-state='bad' class=""><h2 id="then-i-saw-the-code">Then I saw the code</h2>
<p><img src="img/huge-javascript-file.png" alt="huge javascript file"></p>
</section>

<section  class=""><h2 id="my-year-has-been-peacemaking">My year has been peacemaking</h2>
</section>

<section  class=""><h2 id="between-a-mutual-friend-and-a-new-face">Between a mutual friend, and a new face</h2>
</section>

<section data-state='title' class=""><h2 id="our-friend-ng-">Our friend <code>ng</code></h2>
<p><img class='offset' src="img/ng.png" alt="angular js shield logo"></p>
</section>

<section  class=""><h2 id="hefty">Hefty</h2>
</section>

<section  class="undefined"><h2 id="big-ideas">Big ideas</h2>
</section>

<section data-state='title' class=""><h2 id="d3">D3</h2>
</section>

<section  class=""><h2 id="-just-a-library-">&#39;Just a library&#39;</h2>
</section>

<section  class=""><h2 id="has-some-big-ideas-too">Has some big ideas too</h2>
</section>

<section data-state='title' class=""><h2 id="meet-d3">Meet d3</h2>
</section>

<section  class=""><h2 id="d3-jquery-data">d3 ≃ jQuery + data</h2>
</section>

<section  class=""><h2 id="jquery-ish">jQuery-ish</h2>
<ul>
<li>select elements</li>
<li>affect those elements via chaining API</li>
</ul>
</section>

<section  class="notitle"><h2 id="e-g">e.g</h2>
<script type=eg code-sample>
  <svg id=meetD3 width=600 height=220>
    <circle r=50 cx=300 cy=110 fill=black />
  </svg>
</script>

<div class=little-console></div>

<script type=cheat>
  d3.selectAll("#meetD3 circle").attr("fill", "pink");
</script>

</section>

<section  class=""><h2 id="nothing-new-so-far">Nothing new so far</h2>
</section>

<section data-state='subtitle' class=""><h2 id="one-callback-api-turns-jq-into-d3">One callback API turns jQ into D3</h2>
</section>

<section  class=""><h2 id="d3-s-callback">D3&#39;s callback</h2>
<pre><code>d3.selectAll(&quot;.bars&quot;)
.style(&quot;background&quot;,
  function(data) {
    return data.risk &gt; 0.9 ? &quot;red&quot; : &quot;green&quot;;
  });
</code></pre></section>

<section  class=""><h2 id="-data-"><code>(data, ...) {</code></h2>
<ul>
<li>the data for an element</li>
</ul>
</section>

<section  class=""><h2 id="data-visual">Data -&gt; visual</h2>
<pre><code>function aD3Callback(data) {
  // transform data value, into visual value
  return data.count + &quot;px&quot;
}
</code></pre></section>

<section  class=""><h2 id="e-g">e.g</h2>
<pre><code>d3.select(&quot;#root&quot;)
  .selectAll(&quot;div&quot;)
  .style(&quot;width&quot;, function(d) {
    return d.count + &quot;px&quot;;
  });
</code></pre></section>

<section  class=""><h2 id="-and-where-does-the-data-come-from-">...and where does the data come from?</h2>
</section>

<section  class=""><h2 id="-data-"><code>data()</code></h2>
<pre><code>d3.selectAll(&quot;h3&quot;)
  .data([
    {title: &quot;jQuery&quot;},
    {title: &quot;D3&quot;}
  ])
</code></pre></section>

<section  class=""><h2 id="the-data-join-">The data-join!</h2>
</section>

<section  class=""><h2 id="driving-the-document-with-data">Driving the document with data</h2>
</section>

<section  class=""><h2 id="e-g">e.g</h2>
<script type=eg code-sample>
  <svg id=join width=600 height=220>
    <circle r=50 cx=250 cy=110  />
    <circle r=50 cx=450 cy=110  />
  </svg>
</script>

<div class=little-console></div>

<script type=cheat>
  d3.selectAll("#join circle").data([{risk:0.9},{risk:0.1}]).attr("fill", (d) => d.risk > 0.5 ? "red" : "green");
</script>

</section>

<section  class=""><h2 id="synchronising-data-and-screen">Synchronising data and screen</h2>
<ul>
<li>updating </li>
<li>adding</li>
<li>removing</li>
</ul>
</section>

<section  class=""><h2 id="synchronising-data-and-elements">Synchronising data and elements</h2>
<pre><code class="lang-javascript">var update = d3.selectAll(&#39;.x&#39;).data(data);
var enter = update.enter();
var exit = update.exit();
</code></pre>
</section>

<section  class="notitle"><h2 id="contexts-explained">Contexts explained</h2>
<div class=contexts-explained>

  <div class=situation>
    <h2>Selection</h2>
    <h3>Elements</h3>
    <div class='elements track'></div>
    <button class=addEl>Add element</button>
    <button class=delEl>Remove element</button>
    <h3 class=code>.data()</h3>
    <div class='data track'></div>
    <button class=addData>Add data</button>
    <button class=delData>Remove data</button>
  </div>

  <div class=contexts>
    <h2>d3 Contexts</h2>
    <div>
      <h3 class=code>enter()</h3>
      <div class='enter track'></div>
    </div>
    <div>
      <h3 class=code>update</h3>
      <div class='update track'></div>
    </div>
    <div>
      <h3 class=code>exit()</h3>
      <div class='exit track'></div>
    </div>
  </div>

<p></div></p>
</section>

<section data-state='subtitle' class=""><h2 id="big-idea">Big idea</h2>
</section>

<section data-state='subtitle' class=""><h2 id="idempotency">Idempotency</h2>
</section>

<section  class=""><h2 id="d3-components-functions-that-sync-dom-data-">d3 components = functions that sync <code>&lt;DOM&gt;</code> &amp; <code>{data}</code></h2>
</section>

<section  class=""><h2 id="components-are-just-a-function">Components are just a function</h2>
<pre><code>render(elements0, data1) // elements1

render(elements1, data1) // elements1

render(elements1, data2) // elements2

render(elements2, data1) // elements1
</code></pre></section>

<section  class=""><h2 id="so-what-">So what?</h2>
</section>

<section  class=""><h2 id="composition">Composition</h2>
<pre><code class="lang-javascript">var drawLineChart = lineChart();
var drawAxis = axis();
var addLabels = labelGenerator();

function renderXyPlot(data) {
  d3.select(&quot;#chart&quot;)
  .call(drawLineChart, data)
  .call(drawAxis, data)
  .call(addLabels, data)
}
</code></pre>
</section>

<section  class=""><h2 id="collaboration">Collaboration</h2>
<pre><code class="lang-javascript">
function renderXyPlot(data) {
  d3.select(&quot;#chart&quot;)
  .call(drawLineChart, data)
  .call(drawAxis, data)
  .call(addLabels, data)
} 

function renderHeatMap(data) {

  var sectors = heatmap();
  var laidOut = heatmap.nodes(data);

  d3.select(&quot;#chart&quot;)
  .call(renderSectors, sectors)
  .call(renderNodes, laidOut)
}
</code></pre>
</section>

<section  class=""><h2 id="d3-s-big-ideas">d3&#39;s big ideas</h2>
</section>

<section  class="big-text"><h2 id="d3-jquery-data-data-join">d3 ≃ jQuery + data = data-join</h2>
</section>

<section  class=""><h2 id="sync-via-enter-update-and-exit-">Sync via <code>enter()</code>, update and <code>exit()</code></h2>
</section>

<section  class=""><h2 id="composition-collaboration-from-idempotency-">Composition + collaboration (from idempotency)</h2>
</section>

<section data-state='title' class=""><h2 id="using-d3-ng">Using d3 + ng</h2>
</section>

<section  class=""><h2 id="how-to-use-d3-s-powers">How to use D3&#39;s powers</h2>
</section>

<section  class=""><h2 id="without-3-269-line-file-of-doom">Without 3,269 line file of doom</h2>
</section>

<section  class=""><h2 id="or-losing-benefits-of-angular-">Or losing benefits of Angular?</h2>
</section>

<section data-state='subtitle' class=""><h2 id="attempt-one">Attempt one</h2>
</section>

<section  class=""><h2 id="i-brought-best-practice-">I brought &#39;best practice&#39;</h2>
</section>

<section  class=""><h2 id="-ng-view-concerns-live-in-"><code>ng</code> view concerns live in?</h2>
</section>

<section  class=""><h2 id="-directives-"><code>&lt;directives&gt;</code></h2>
</section>

<section  class=""><h2 id="app-flavoured-html">App-flavoured HTML</h2>
<pre><code class="lang-html">&lt;!-- BOOO!! --&gt;
&lt;div class=&#39;profile&#39;&gt;&lt;/div&gt;

&lt;!-- YAAAAY! --&gt;
&lt;profile&gt;&lt;/profile&gt;
`
</code></pre>
</section>

<section  class=""><h2 id="one-directive-per-chart">One directive per chart</h2>
</section>

<section  class=""><h2 id="approach-lots-of-libraries-have-taken">Approach lots of libraries have taken</h2>
</section>

<section  class=""><h2 id="-bar-chart-"><code>&lt;bar-chart&gt;</code></h2>
<pre><code>&lt;div ng-controller=&#39;ReportCtrl as ctrl&#39;&gt;
  &lt;bar-chart
    series=&quot;ctrl.series&quot;
    y-scale=&quot;ctrl.yScale&quot;
    &gt;
  &lt;/bar-chart&gt;
&lt;/div&gt;
</code></pre></section>

<section  class=""><h2 id="sometimes-great-">Sometimes, great!</h2>
</section>

<section  class=""><h2 id="e-g-cool-inputs">e.g cool inputs</h2>
</section>

<section data-state='bad' class=""><h2 id="but-">But...</h2>
</section>

<section  class=""><h2 id="they-were-not-impressed">They were not impressed</h2>
</section>

<section  class=""><h2 id="remember-collaboration-">Remember collaboration?</h2>
</section>

<section  class=""><h2 id="seamless-transitions-between-components">Seamless transitions between components</h2>
</section>

<section  class=""><h2 id="same-elements">Same elements</h2>
</section>

<section data-state='bad' class=""><h2 id="first-d3-ng-bust-up">First d3 + ng bust up</h2>
</section>

<section  class=""><h2 id="the-selfishness-of-components-">The selfishness of <code>&lt;components&gt;</code></h2>
</section>

<section  class=""><h2 id="-components-won-t-share-their-dom"><code>&lt;components&gt;</code> won&#39;t share their DOM</h2>
</section>

<section  class=""><h2 id="no-overlapping-behaviours">No overlapping behaviours</h2>
<p><img src="img/oo.png" alt="overlap"></p>
</section>

<section  class=""><h2 id="oo-view-of-dom">OO view of DOM</h2>
<p>Implementation detail to be hidden</p>
</section>

<section  class=""><h2 id="d3-view-of-dom">D3 view of DOM</h2>
<p>Simple data, ready to be used</p>
</section>

<section  class=""><h2 id="embrace-data">Embrace data</h2>
<blockquote>
<p> Better have 100 functions for 1 data structure than 10 functions for 10 data structures</p>
</blockquote>
<p>Alan Perlis</p>
</section>

<section  class=""><h2 id="why-different-">Why different?</h2>
<p>D3 is idempotent, DOM is just more data</p>
</section>

<section data-state='subtitle' class=""><h2 id="attempt-two">Attempt two</h2>
</section>

<section  class=""><h2 id="stacking-attributes">Stacking attributes</h2>
</section>

<section  class=""><h2 id="attribute-directives">Attribute directives</h2>
<pre><code>&lt;svg

  bar-chart=&#39;{
    data: ctrl.data,
  }&#39;

  line-graph=&#39;{
    data: ctrl.data,
  }&#39;
  &gt;
&lt;/svg&gt;
</code></pre></section>

<section data-state='good' class=""><h2 id="can-share-">Can share!</h2>
<p>DOM nodes accessible to all directives</p>
<pre><code>&lt;svg bar-chart line-graph&gt;
  &lt;g class=&#39;some-data&#39;&gt;&lt;/g&gt;
  &lt;g class=&#39;some-data&#39;&gt;&lt;/g&gt;
  &lt;g class=&#39;some-data&#39;&gt;&lt;/g&gt;
&lt;/svg&gt;
</code></pre></section>

<section data-state='bad' class=""><h2 id="but-">But..</h2>
</section>

<section  class=""><h2 id="no-isolate-">No isolate...</h2>
<p><img src="img/no-dupes.png" alt="no dupes"></p>
</section>

<section  class=""><h2 id="too-many-wtfs-from-team">Too many WTFs from team</h2>
</section>

<section  class=""><h2 id="gain-collaboration-still-no-composition">Gain collaboration, still no composition</h2>
</section>

<section data-state='bad' class=""><h2 id="so-">So...</h2>
</section>

<section data-state='bad' class=""><h2 id="i-had-a-moment-of-doubt">I had a moment of doubt</h2>
</section>

<section  class=""><h2 id="why-do-all-the-apps-i-build-look-the-same-">Why do all the apps I build look the same?</h2>
</section>

<section  class=""><h2 id="why-did-people-new-to-d3-ng-build-cooler-stuff-than-me-">Why did people new to D3 + ng build cooler stuff than me?</h2>
</section>

<section  class=""><h2 id="something-was-wrong-with-me">Something was wrong with me</h2>
</section>

<section  class=""><h2 id="programmer-vision">Programmer vision</h2>
</section>

<section  class=""><h2 id="a-world-of-hierarchy">A world of hierarchy</h2>
</section>

<section  class=""><h2 id="-and-rules">...and rules</h2>
</section>

<section  class=""><h2 id="where-simple-things-were-impossible">Where simple things were impossible</h2>
</section>

<section  class=""><h2 id="where-doing-it-the-right-way-">Where doing it the &#39;right way&#39;</h2>
</section>

<section  class=""><h2 id="was-more-important-than-doing-it-at-all">Was more important than doing it at all</h2>
</section>

<section data-state='title' class=""><h2 id="the-challenge">The challenge</h2>
</section>

<section  class=""><h2 id="to-see-afresh">To see afresh</h2>
</section>

<section  class=""><h2 id="brief">Brief</h2>
<ul>
<li>x/y plot</li>
<li>editable data</li>
<li>update on change</li>
</ul>
</section>

<section  class=""><h2 id="pfff-too-easy">Pfff! Too easy</h2>
</section>

<section  class=""><h2 id="auto-pilot">Auto-pilot</h2>
<p><img src="img/chart-boring.png" alt="boring chart"></p>
</section>

<section  class=""><h2 id="add-modal">Add modal</h2>
<p><img src="img/chart-modal.png" alt="boring modal"></p>
</section>

<section data-state='bad' class=""><h2 id="no-programmer-vision-">NO! PROGRAMMER VISION!</h2>
</section>

<section  class=""><h2 id="direct-access">Direct access</h2>
</section>

<section  class=""><h2 id="but-how-">But how?</h2>
</section>

<section  class=""><h2 id="angular-s-d3-s-powers">Angular&#39;s + d3&#39;s powers</h2>
</section>

<section  class=""><h2 id="beat-the-tools-into-submission-">Beat the tools into submission!</h2>
</section>

<section  class=""><h2 id="-d3-angularize-"><code>d3.angularize()</code></h2>
</section>

<section  class=""><h2 id="flip-the-hierarchy-">Flip the hierarchy!</h2>
</section>

<section  class=""><h2 id="-"> </h2>
<svg id='realisationDemo' class="demo"></svg>

<script>
setTimeout(function() {
  // .eq is for marked's annoying parser
  onSlideWithElementShown($("#realisationDemo").eq(0)[0], resolutionDemo.fromHook)
});
</script>

</section>

<section  class=""><h2 id="-"> </h2>
</section>

</div>
</div>

<!-- demo code -->
<script src="js/jquery.js"></script>
<script src="js/lodash.js"></script>
<script src="js/angular.js"></script>
<script src="js/d3.js"></script>
<script src="js/demo.js"></script>
<script src="js/DonutChartCtrl.js"></script>

<!-- reveal -->
<script src="reveal/lib/js/head.min.js"></script>
<script src="reveal/plugin/highlight/highlight.js"></script>
<script src="reveal/js/reveal.min.js"></script>
<script src="js/revealConfig.js"></script>

<script src="js/revealHooks.js"></script>

<!-- demos -->
<script src=js/d3-contexts-explained.js></script>
<script src=experiments/ng-d3.js></script>
<script src=experiments/app.js></script>

<!-- live coding -->
<script src=js/little-console.js></script>
<script src=js/showConsoles.js></script>

</body>
